<!DOCTYPE html>
<html lang="tt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>–¢–∞—Ç–∞—Ä—á–∞ ‚Äî –£—á–∏ —Ç–∞—Ç–∞—Ä—Å–∫–∏–π</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { 
      font-family: 'Nunito', sans-serif;
      background: linear-gradient(135deg, #1a472a 0%, #2d5a3d 50%, #1a472a 100%);
      min-height: 100vh;
      color: #fff;
    }
    .app { min-height: 100vh; position: relative; overflow-x: hidden; }
    .pattern-bg {
      position: fixed; top: 0; left: 0; right: 0; bottom: 0; opacity: 0.05; pointer-events: none;
      background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M30 0L60 30L30 60L0 30L30 0z' fill='%23fff'/%3E%3C/svg%3E");
      background-size: 30px 30px;
    }
    .btn {
      background: linear-gradient(135deg, #4ade80, #22c55e);
      border: none; padding: 16px 32px; border-radius: 16px;
      color: #1a472a; font-weight: 700; font-size: 16px; cursor: pointer;
      transition: all 0.3s; box-shadow: 0 4px 15px rgba(74,222,128,0.4);
    }
    .btn:hover { transform: translateY(-2px); }
    .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
    .btn-secondary {
      background: rgba(255,255,255,0.1); color: #fff;
      box-shadow: none; border: 2px solid rgba(255,255,255,0.2);
    }
    .btn-premium {
      background: linear-gradient(135deg, #f59e0b, #d97706);
      box-shadow: 0 4px 15px rgba(245,158,11,0.4);
    }
    .card {
      background: rgba(255,255,255,0.1); backdrop-filter: blur(10px);
      border-radius: 20px; border: 1px solid rgba(255,255,255,0.1);
      transition: all 0.3s;
    }
    .card:hover { transform: translateY(-4px); box-shadow: 0 10px 40px rgba(0,0,0,0.2); }
    .quiz-option {
      width: 100%; padding: 16px 20px; background: rgba(255,255,255,0.1);
      border: 2px solid rgba(255,255,255,0.2); border-radius: 12px;
      color: #fff; font-size: 16px; font-weight: 600; cursor: pointer;
      transition: all 0.3s; text-align: left;
    }
    .quiz-option:hover:not(:disabled) { background: rgba(255,255,255,0.2); }
    .quiz-option.correct { background: rgba(74,222,128,0.3); border-color: #4ade80; }
    .quiz-option.incorrect { background: rgba(239,68,68,0.3); border-color: #ef4444; }
    .filter-btn {
      padding: 8px 16px; border-radius: 20px; border: none;
      font-weight: 600; cursor: pointer; font-size: 14px; transition: all 0.3s;
    }
    .filter-btn.active { background: #4ade80; color: #1a472a; }
    .filter-btn:not(.active) { background: rgba(255,255,255,0.1); color: #fff; }
    .flash-card { perspective: 1000px; height: 280px; cursor: pointer; }
    .flash-card-inner {
      position: relative; width: 100%; height: 100%;
      transition: transform 0.6s; transform-style: preserve-3d;
    }
    .flash-card-inner.flipped { transform: rotateY(180deg); }
    .flash-card-front, .flash-card-back {
      position: absolute; width: 100%; height: 100%; backface-visibility: hidden;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      border-radius: 24px; padding: 32px;
    }
    .flash-card-front { background: linear-gradient(135deg, rgba(255,255,255,0.15), rgba(255,255,255,0.05)); }
    .flash-card-back { transform: rotateY(180deg); background: linear-gradient(135deg, #4ade80, #22c55e); }
    .theory-block {
      background: rgba(255,255,255,0.05); border-radius: 16px;
      padding: 20px; margin-bottom: 20px; white-space: pre-line; line-height: 1.7;
    }
    .scrollable { max-height: 60vh; overflow-y: auto; padding-right: 8px; }
    .scrollable::-webkit-scrollbar { width: 6px; }
    .scrollable::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); border-radius: 3px; }
    .scrollable::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 3px; }
    .locked { opacity: 0.5; position: relative; }
    .locked::after {
      content: 'üîí'; position: absolute; right: 16px; top: 50%; transform: translateY(-50%);
      font-size: 20px;
    }
    .premium-badge {
      background: linear-gradient(135deg, #f59e0b, #d97706);
      padding: 4px 12px; border-radius: 12px; font-size: 12px; font-weight: 700;
    }
    .premium-banner {
      background: linear-gradient(135deg, rgba(245,158,11,0.2), rgba(217,119,6,0.2));
      border: 1px solid rgba(245,158,11,0.3); border-radius: 16px;
      padding: 20px; margin-bottom: 20px; text-align: center;
    }
    .loading { display: flex; justify-content: center; align-items: center; min-height: 200px; }
    .spinner {
      width: 40px; height: 40px; border: 4px solid rgba(255,255,255,0.1);
      border-top-color: #4ade80; border-radius: 50%; animation: spin 1s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    @keyframes pulse { 0%,100% { transform: scale(1); } 50% { transform: scale(1.05); } }
    @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    .lesson-item { animation: slideUp 0.4s ease forwards; opacity: 0; }
  </style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
// ===== –ö–û–ù–§–ò–ì =====
const API_URL = window.location.hostname === 'localhost' 
  ? 'http://localhost:8000' 
  : 'https://tatar-backend.amvera.io'; // –ó–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–π URL Amvera

const FREE_LESSONS = 10; // –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ —É—Ä–æ–∫–∏

// Telegram WebApp
const tg = window.Telegram?.WebApp;
if (tg) {
  tg.ready();
  tg.expand();
}

// –ü–æ–ª—É—á–∏—Ç—å initData –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
const getInitData = () => tg?.initData || '';

// API —Ñ—É–Ω–∫—Ü–∏–∏
const api = {
  async getUser() {
    const res = await fetch(`${API_URL}/api/user`, {
      headers: { 'Authorization': getInitData() }
    });
    return res.json();
  },
  
  async saveProgress(data) {
    const res = await fetch(`${API_URL}/api/progress`, {
      method: 'POST',
      headers: { 
        'Content-Type': 'application/json',
        'Authorization': getInitData() 
      },
      body: JSON.stringify(data)
    });
    return res.json();
  },
  
  async createInvoice(months) {
    const res = await fetch(`${API_URL}/api/create-invoice`, {
      method: 'POST',
      headers: { 
        'Content-Type': 'application/json',
        'Authorization': getInitData() 
      },
      body: JSON.stringify({ months })
    });
    return res.json();
  },
  
  async checkPremium() {
    const res = await fetch(`${API_URL}/api/check-premium`, {
      headers: { 'Authorization': getInitData() }
    });
    return res.json();
  }
};

// ===== –î–ê–ù–ù–´–ï –£–†–û–ö–û–í =====
const vocabularyLessons = [
  { id: 1, title: "–ò—Å”ô–Ω–º–µ—Å–µ–∑!", subtitle: "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è", icon: "üëã", category: "vocabulary",
    words: [
      { tatar: "–ò—Å”ô–Ω–º–µ—Å–µ–∑", russian: "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ" },
      { tatar: "–°”ô–ª–∞–º", russian: "–ü—Ä–∏–≤–µ—Ç" },
      { tatar: "–•”ô–µ—Ä–ª–µ –∏—Ä—Ç”ô", russian: "–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ" },
      { tatar: "–•”ô–µ—Ä–ª–µ –∫”©–Ω", russian: "–î–æ–±—Ä—ã–π –¥–µ–Ω—å" },
      { tatar: "–•”ô–µ—Ä–ª–µ –∫–∏—á", russian: "–î–æ–±—Ä—ã–π –≤–µ—á–µ—Ä" },
      { tatar: "–°–∞—É –±—É–ª—ã–≥—ã–∑", russian: "–î–æ —Å–≤–∏–¥–∞–Ω–∏—è" },
      { tatar: "–•—É—à—ã–≥—ã–∑", russian: "–ü—Ä–æ—â–∞–π—Ç–µ" },
      { tatar: "–ö“Ø—Ä–µ—à–∫”ô–Ω–≥”ô —à–∞—Ç", russian: "–†–∞–¥ –≤—Å—Ç—Ä–µ—á–µ" },
    ]
  },
  { id: 2, title: "–°–∞–Ω–Ω–∞—Ä 1-10", subtitle: "–ß–∏—Å–ª–∞", icon: "üî¢", category: "vocabulary",
    words: [
      { tatar: "–ë–µ—Ä", russian: "–û–¥–∏–Ω" }, { tatar: "–ò–∫–µ", russian: "–î–≤–∞" },
      { tatar: "”®—á", russian: "–¢—Ä–∏" }, { tatar: "–î“Ø—Ä—Ç", russian: "–ß–µ—Ç—ã—Ä–µ" },
      { tatar: "–ë–∏—à", russian: "–ü—è—Ç—å" }, { tatar: "–ê–ª—Ç—ã", russian: "–®–µ—Å—Ç—å" },
      { tatar: "“ñ–∏–¥–µ", russian: "–°–µ–º—å" }, { tatar: "–°–∏–≥–µ–∑", russian: "–í–æ—Å–µ–º—å" },
      { tatar: "–¢—É–≥—ã–∑", russian: "–î–µ–≤—è—Ç—å" }, { tatar: "–£–Ω", russian: "–î–µ—Å—è—Ç—å" },
    ]
  },
  { id: 3, title: "–°–∞–Ω–Ω–∞—Ä 11-100", subtitle: "–ë–æ–ª—å—à–∏–µ —á–∏—Å–ª–∞", icon: "üíØ", category: "vocabulary",
    words: [
      { tatar: "–£–Ω –±–µ—Ä", russian: "–û–¥–∏–Ω–Ω–∞–¥—Ü–∞—Ç—å" }, { tatar: "–ï–≥–µ—Ä–º–µ", russian: "–î–≤–∞–¥—Ü–∞—Ç—å" },
      { tatar: "–£—Ç—ã–∑", russian: "–¢—Ä–∏–¥—Ü–∞—Ç—å" }, { tatar: "–ö—ã—Ä—ã–∫", russian: "–°–æ—Ä–æ–∫" },
      { tatar: "–ò–ª–ª–µ", russian: "–ü—è—Ç—å–¥–µ—Å—è—Ç" }, { tatar: "–ê–ª—Ç–º—ã—à", russian: "–®–µ—Å—Ç—å–¥–µ—Å—è—Ç" },
      { tatar: "“ñ–∏—Ç–º–µ—à", russian: "–°–µ–º—å–¥–µ—Å—è—Ç" }, { tatar: "–°–∏–∫—Å”ô–Ω", russian: "–í–æ—Å–µ–º—å–¥–µ—Å—è—Ç" },
      { tatar: "–¢—É–∫—Å–∞–Ω", russian: "–î–µ–≤—è–Ω–æ—Å—Ç–æ" }, { tatar: "–ô”©–∑", russian: "–°—Ç–æ" },
    ]
  },
  { id: 4, title: "–ì–∞–∏–ª”ô", subtitle: "–°–µ–º—å—è", icon: "üë®‚Äçüë©‚Äçüëß‚Äçüë¶", category: "vocabulary",
    words: [
      { tatar: "”ò–Ω–∏", russian: "–ú–∞–º–∞" }, { tatar: "”ò—Ç–∏", russian: "–ü–∞–ø–∞" },
      { tatar: "”ò–±–∏", russian: "–ë–∞–±—É—à–∫–∞" }, { tatar: "–ë–∞–±–∞–π", russian: "–î–µ–¥—É—à–∫–∞" },
      { tatar: "–ê–ø–∞", russian: "–°—Ç–∞—Ä—à–∞—è —Å–µ—Å—Ç—Ä–∞" }, { tatar: "–ê–±—ã–π", russian: "–°—Ç–∞—Ä—à–∏–π –±—Ä–∞—Ç" },
      { tatar: "–°–µ“£–µ–ª", russian: "–ú–ª–∞–¥—à–∞—è —Å–µ—Å—Ç—Ä–∞" }, { tatar: "–≠–Ω–µ", russian: "–ú–ª–∞–¥—à–∏–π –±—Ä–∞—Ç" },
      { tatar: "–£–ª—ã–º", russian: "–°—ã–Ω" }, { tatar: "–ö—ã–∑—ã–º", russian: "–î–æ—á—å" },
    ]
  },
  { id: 5, title: "–¢”©—Å–ª”ô—Ä", subtitle: "–¶–≤–µ—Ç–∞", icon: "üé®", category: "vocabulary",
    words: [
      { tatar: "–ê–∫", russian: "–ë–µ–ª—ã–π" }, { tatar: "–ö–∞—Ä–∞", russian: "–ß—ë—Ä–Ω—ã–π" },
      { tatar: "–ö—ã–∑—ã–ª", russian: "–ö—Ä–∞—Å–Ω—ã–π" }, { tatar: "–Ø—à–µ–ª", russian: "–ó–µ–ª—ë–Ω—ã–π" },
      { tatar: "–ó”ô“£–≥”ô—Ä", russian: "–°–∏–Ω–∏–π" }, { tatar: "–°–∞—Ä—ã", russian: "–ñ—ë–ª—Ç—ã–π" },
      { tatar: "–ö”©—Ä”ô–Ω", russian: "–ö–æ—Ä–∏—á–Ω–µ–≤—ã–π" }, { tatar: "–°–æ—Ä—ã", russian: "–°–µ—Ä—ã–π" },
    ]
  },
  { id: 6, title: "–ê—à–∞–º–ª—ã–∫–ª–∞—Ä", subtitle: "–ï–¥–∞", icon: "üçΩÔ∏è", category: "vocabulary",
    words: [
      { tatar: "–ò–ø–∏", russian: "–•–ª–µ–±" }, { tatar: "–°”©—Ç", russian: "–ú–æ–ª–æ–∫–æ" },
      { tatar: "–ò—Ç", russian: "–ú—è—Å–æ" }, { tatar: "–ß”ô–π", russian: "–ß–∞–π" },
      { tatar: "–ê–ª–º–∞", russian: "–Ø–±–ª–æ–∫–æ" }, { tatar: "–ë–∞–ª", russian: "–ú—ë–¥" },
      { tatar: "”®—á–ø–æ—á–º–∞–∫", russian: "–≠—á–ø–æ—á–º–∞–∫" }, { tatar: "–ß”ô–∫-—á”ô–∫", russian: "–ß–∞–∫-—á–∞–∫" },
    ]
  },
  { id: 7, title: "–≠—á–µ–º–ª–µ–∫–ª”ô—Ä", subtitle: "–ù–∞–ø–∏—Ç–∫–∏", icon: "ü•§", category: "vocabulary",
    words: [
      { tatar: "–°—É", russian: "–í–æ–¥–∞" }, { tatar: "–ß”ô–π", russian: "–ß–∞–π" },
      { tatar: "–ö–æ—Ñ–µ", russian: "–ö–æ—Ñ–µ" }, { tatar: "–°”©—Ç", russian: "–ú–æ–ª–æ–∫–æ" },
      { tatar: "–°–æ–∫", russian: "–°–æ–∫" }, { tatar: "–ê–π—Ä–∞–Ω", russian: "–ê–π—Ä–∞–Ω" },
    ]
  },
  { id: 8, title: "–Ø—à–µ–ª—á”ô–ª”ô—Ä", subtitle: "–û–≤–æ—â–∏", icon: "ü•ï", category: "vocabulary",
    words: [
      { tatar: "–ö–∏—à–µ—Ä", russian: "–ú–æ—Ä–∫–æ–≤—å" }, { tatar: "–ë”ô—Ä”ô“£–≥–µ", russian: "–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å" },
      { tatar: "–ö—ã—è—Ä", russian: "–û–≥—É—Ä–µ—Ü" }, { tatar: "–ü–æ–º–∏–¥–æ—Ä", russian: "–ü–æ–º–∏–¥–æ—Ä" },
      { tatar: "–ö”ô–±–µ—Å—Ç”ô", russian: "–ö–∞–ø—É—Å—Ç–∞" }, { tatar: "–°—É–≥–∞–Ω", russian: "–õ—É–∫" },
    ]
  },
  { id: 9, title: "“ñ–∏–ª”ô–∫-“ó–∏–º–µ—à", subtitle: "–§—Ä—É–∫—Ç—ã", icon: "üçé", category: "vocabulary",
    words: [
      { tatar: "–ê–ª–º–∞", russian: "–Ø–±–ª–æ–∫–æ" }, { tatar: "–ê—Ä–º—É—Ç", russian: "–ì—Ä—É—à–∞" },
      { tatar: "”®–∑–µ–º", russian: "–í–∏–Ω–æ–≥—Ä–∞–¥" }, { tatar: "–ß–∏—è", russian: "–í–∏—à–Ω—è" },
      { tatar: "“ñ–∏–ª”ô–∫", russian: "–Ø–≥–æ–¥–∞" }, { tatar: "–ö—ã–∑—ã–ª—ä—è—Ä", russian: "–ö–ª—É–±–Ω–∏–∫–∞" },
    ]
  },
  { id: 10, title: "–•–∞–π–≤–∞–Ω–Ω–∞—Ä", subtitle: "–î–æ–º–∞—à–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω—ã–µ", icon: "üêæ", category: "vocabulary",
    words: [
      { tatar: "–≠—Ç", russian: "–°–æ–±–∞–∫–∞" }, { tatar: "–ú”ô—á–µ", russian: "–ö–æ—à–∫–∞" },
      { tatar: "–ê—Ç", russian: "–õ–æ—à–∞–¥—å" }, { tatar: "–°—ã–µ—Ä", russian: "–ö–æ—Ä–æ–≤–∞" },
      { tatar: "–°–∞—Ä—ã–∫", russian: "–û–≤—Ü–∞" }, { tatar: "–ö”ô“ó”ô", russian: "–ö–æ–∑–∞" },
    ]
  },
  // –ü—Ä–µ–º–∏—É–º —É—Ä–æ–∫–∏ (11-35)
  { id: 11, title: "–ö—ã—Ä–≥—ã–π —Ö–∞–π–≤–∞–Ω–Ω–∞—Ä", subtitle: "–î–∏–∫–∏–µ –∂–∏–≤–æ—Ç–Ω—ã–µ", icon: "ü¶ä", category: "vocabulary", premium: true,
    words: [
      { tatar: "–ê—é", russian: "–ú–µ–¥–≤–µ–¥—å" }, { tatar: "–ë“Ø—Ä–µ", russian: "–í–æ–ª–∫" },
      { tatar: "–¢”©–ª–∫–µ", russian: "–õ–∏—Å–∞" }, { tatar: "–ö—É—è–Ω", russian: "–ó–∞—è—Ü" },
      { tatar: "–ö–µ—Ä–ø–µ", russian: "–Å–∂" }, { tatar: "–¢–∏–µ–Ω", russian: "–ë–µ–ª–∫–∞" },
    ]
  },
  { id: 12, title: "–ö–æ—à–ª–∞—Ä", subtitle: "–ü—Ç–∏—Ü—ã", icon: "ü¶Ö", category: "vocabulary", premium: true,
    words: [
      { tatar: "–ö–æ—à", russian: "–ü—Ç–∏—Ü–∞" }, { tatar: "–ö–∞—Ä–≥–∞", russian: "–í–æ—Ä–æ–Ω–∞" },
      { tatar: "–ß—ã–ø—á—ã–∫", russian: "–í–æ—Ä–æ–±–µ–π" }, { tatar: "–°–∞–Ω–¥—É–≥–∞—á", russian: "–°–æ–ª–æ–≤–µ–π" },
      { tatar: "–ê–∫–∫–æ—à", russian: "–õ–µ–±–µ–¥—å" }, { tatar: "–ë”©—Ä–∫–µ—Ç", russian: "–û—Ä—ë–ª" },
    ]
  },
  { id: 13, title: "–ê—Ç–Ω–∞ –∫”©–Ω–Ω”ô—Ä–µ", subtitle: "–î–Ω–∏ –Ω–µ–¥–µ–ª–∏", icon: "üìÖ", category: "vocabulary", premium: true,
    words: [
      { tatar: "–î“Ø—à”ô–º–±–µ", russian: "–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫" }, { tatar: "–°–∏—à”ô–º–±–µ", russian: "–í—Ç–æ—Ä–Ω–∏–∫" },
      { tatar: "–ß”ô—Ä—à”ô–º–±–µ", russian: "–°—Ä–µ–¥–∞" }, { tatar: "–ü”ô–Ω“ó–µ—à”ô–º–±–µ", russian: "–ß–µ—Ç–≤–µ—Ä–≥" },
      { tatar: "“ñ–æ–º–≥–∞", russian: "–ü—è—Ç–Ω–∏—Ü–∞" }, { tatar: "–®–∏–º–±”ô", russian: "–°—É–±–±–æ—Ç–∞" },
      { tatar: "–Ø–∫—à”ô–º–±–µ", russian: "–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ" },
    ]
  },
  { id: 14, title: "–í–∞–∫—ã—Ç", subtitle: "–í—Ä–µ–º—è", icon: "‚è∞", category: "vocabulary", premium: true,
    words: [
      { tatar: "–ë“Ø–≥–µ–Ω", russian: "–°–µ–≥–æ–¥–Ω—è" }, { tatar: "–ò—Ä—Ç”ô–≥”ô", russian: "–ó–∞–≤—Ç—Ä–∞" },
      { tatar: "–ö–∏—á”ô", russian: "–í—á–µ—Ä–∞" }, { tatar: "–ò—Ä—Ç”ô–Ω", russian: "–£—Ç—Ä–æ–º" },
      { tatar: "–ö”©–Ω–¥–µ–∑", russian: "–î–Ω—ë–º" }, { tatar: "–ö–∏—á–µ–Ω", russian: "–í–µ—á–µ—Ä–æ–º" },
    ]
  },
  { id: 15, title: "–¢”ô–Ω ”ô–≥—ä–∑–∞–ª–∞—Ä—ã", subtitle: "–ß–∞—Å—Ç–∏ —Ç–µ–ª–∞", icon: "ü´Ä", category: "vocabulary", premium: true,
    words: [
      { tatar: "–ë–∞—à", russian: "–ì–æ–ª–æ–≤–∞" }, { tatar: "–ö“Ø–∑", russian: "–ì–ª–∞–∑" },
      { tatar: "–ö–æ–ª–∞–∫", russian: "–£—Ö–æ" }, { tatar: "–ë–æ—Ä—ã–Ω", russian: "–ù–æ—Å" },
      { tatar: "–ê–≤—ã–∑", russian: "–†–æ—Ç" }, { tatar: "–ö—É–ª", russian: "–†—É–∫–∞" },
      { tatar: "–ê—è–∫", russian: "–ù–æ–≥–∞" }, { tatar: "–ô”©—Ä”ô–∫", russian: "–°–µ—Ä–¥—Ü–µ" },
    ]
  },
  { id: 16, title: "–¢–∞–±–∏–≥–∞—Ç—å", subtitle: "–ü—Ä–∏—Ä–æ–¥–∞", icon: "üå≤", category: "vocabulary", premium: true,
    words: [
      { tatar: "–ê–≥–∞—á", russian: "–î–µ—Ä–µ–≤–æ" }, { tatar: "–ß”ô—á”ô–∫", russian: "–¶–≤–µ—Ç–æ–∫" },
      { tatar: "–ï–ª–≥–∞", russian: "–†–µ–∫–∞" }, { tatar: "–ö“Ø–ª", russian: "–û–∑–µ—Ä–æ" },
      { tatar: "–¢–∞—É", russian: "–ì–æ—Ä–∞" }, { tatar: "–£—Ä–º–∞–Ω", russian: "–õ–µ—Å" },
    ]
  },
  { id: 17, title: "“∫–∞–≤–∞ —Ç–æ—Ä—ã—à—ã", subtitle: "–ü–æ–≥–æ–¥–∞", icon: "üå§Ô∏è", category: "vocabulary", premium: true,
    words: [
      { tatar: "“ñ—ã–ª—ã", russian: "–¢–µ–ø–ª–æ" }, { tatar: "–°–∞–ª–∫—ã–Ω", russian: "–•–æ–ª–æ–¥–Ω–æ" },
      { tatar: "–≠—Å—Å–µ", russian: "–ñ–∞—Ä–∫–æ" }, { tatar: "–Ø“£–≥—ã—Ä", russian: "–î–æ–∂–¥—å" },
      { tatar: "–ö–∞—Ä", russian: "–°–Ω–µ–≥" }, { tatar: "“ñ–∏–ª", russian: "–í–µ—Ç–µ—Ä" },
    ]
  },
  { id: 18, title: "”®–π", subtitle: "–î–æ–º", icon: "üè†", category: "vocabulary", premium: true,
    words: [
      { tatar: "”®–π", russian: "–î–æ–º" }, { tatar: "–ë“Ø–ª–º”ô", russian: "–ö–æ–º–Ω–∞—Ç–∞" },
      { tatar: "–ò—à–µ–∫", russian: "–î–≤–µ—Ä—å" }, { tatar: "–¢”ô—Ä”ô–∑”ô", russian: "–û–∫–Ω–æ" },
      { tatar: "”®—Å—Ç”ô–ª", russian: "–°—Ç–æ–ª" }, { tatar: "–£—Ä—ã–Ω–¥—ã–∫", russian: "–°—Ç—É–ª" },
    ]
  },
  { id: 19, title: "–ö–∏–µ–º-—Å–∞–ª—ã–º", subtitle: "–û–¥–µ–∂–¥–∞", icon: "üëï", category: "vocabulary", premium: true,
    words: [
      { tatar: "–ö“Ø–ª–º”ô–∫", russian: "–†—É–±–∞—à–∫–∞" }, { tatar: "–ß–∞–ª–±–∞—Ä", russian: "–ë—Ä—é–∫–∏" },
      { tatar: "–ö“Ø–ª–¥”ô–∫", russian: "–ü–ª–∞—Ç—å–µ" }, { tatar: "–ò—Ç–µ–∫", russian: "–°–∞–ø–æ–≥–∏" },
      { tatar: "–ë“Ø—Ä–µ–∫", russian: "–®–∞–ø–∫–∞" }, { tatar: "–¢“Ø–±”ô—Ç”ô–π", russian: "–¢—é–±–µ—Ç–µ–π–∫–∞" },
    ]
  },
  { id: 20, title: "–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç", subtitle: "–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç", icon: "üöó", category: "vocabulary", premium: true,
    words: [
      { tatar: "–ú–∞—à–∏–Ω–∞", russian: "–ú–∞—à–∏–Ω–∞" }, { tatar: "–ê–≤—Ç–æ–±—É—Å", russian: "–ê–≤—Ç–æ–±—É—Å" },
      { tatar: "–ü–æ–µ–∑–¥", russian: "–ü–æ–µ–∑–¥" }, { tatar: "–°–∞–º–æ–ª—ë—Ç", russian: "–°–∞–º–æ–ª—ë—Ç" },
      { tatar: "–Æ–ª", russian: "–î–æ—Ä–æ–≥–∞" }, { tatar: "–¢—É–∫—Ç–∞–ª—ã—à", russian: "–û—Å—Ç–∞–Ω–æ–≤–∫–∞" },
    ]
  },
  { id: 21, title: "–®”ô“ª”ô—Ä", subtitle: "–ì–æ—Ä–æ–¥", icon: "üèôÔ∏è", category: "vocabulary", premium: true,
    words: [
      { tatar: "–®”ô“ª”ô—Ä", russian: "–ì–æ—Ä–æ–¥" }, { tatar: "–ê–≤—ã–ª", russian: "–î–µ—Ä–µ–≤–Ω—è" },
      { tatar: "–£—Ä–∞–º", russian: "–£–ª–∏—Ü–∞" }, { tatar: "–ö“Ø–ø–µ—Ä", russian: "–ú–æ—Å—Ç" },
      { tatar: "–ú”ô–π–¥–∞–Ω", russian: "–ü–ª–æ—â–∞–¥—å" }, { tatar: "–ú”ô—á–µ—Ç", russian: "–ú–µ—á–µ—Ç—å" },
    ]
  },
  { id: 22, title: "–ü—Ä–æ—Ñ–µ—Å—Å–∏—è–ª”ô—Ä", subtitle: "–ü—Ä–æ—Ñ–µ—Å—Å–∏–∏", icon: "üë®‚Äç‚öïÔ∏è", category: "vocabulary", premium: true,
    words: [
      { tatar: "–£–∫—ã—Ç—É—á—ã", russian: "–£—á–∏—Ç–µ–ª—å" }, { tatar: "–¢–∞–±–∏–±", russian: "–í—Ä–∞—á" },
      { tatar: "–ò–Ω–∂–µ–Ω–µ—Ä", russian: "–ò–Ω–∂–µ–Ω–µ—Ä" }, { tatar: "–°–∞—Ç—É—á—ã", russian: "–ü—Ä–æ–¥–∞–≤–µ—Ü" },
      { tatar: "–ê—à–ø–∞–∑", russian: "–ü–æ–≤–∞—Ä" }, { tatar: "–Ø–∑—É—á—ã", russian: "–ü–∏—Å–∞—Ç–µ–ª—å" },
    ]
  },
  { id: 23, title: "–ú”ô–∫—Ç”ô–ø", subtitle: "–®–∫–æ–ª–∞", icon: "üè´", category: "vocabulary", premium: true,
    words: [
      { tatar: "–ú”ô–∫—Ç”ô–ø", russian: "–®–∫–æ–ª–∞" }, { tatar: "–°—ã–π–Ω—ã—Ñ", russian: "–ö–ª–∞—Å—Å" },
      { tatar: "–£–∫—É—á—ã", russian: "–£—á–µ–Ω–∏–∫" }, { tatar: "–î”ô—Ä–µ—Å", russian: "–£—Ä–æ–∫" },
      { tatar: "–ö–∏—Ç–∞–ø", russian: "–ö–Ω–∏–≥–∞" }, { tatar: "–î”ô—Ñ—Ç”ô—Ä", russian: "–¢–µ—Ç—Ä–∞–¥—å" },
    ]
  },
  { id: 24, title: "–•–∏—Å–ª”ô—Ä", subtitle: "–≠–º–æ—Ü–∏–∏", icon: "üòä", category: "vocabulary", premium: true,
    words: [
      { tatar: "–®–∞—Ç–ª—ã–∫", russian: "–†–∞–¥–æ—Å—Ç—å" }, { tatar: "–ö–∞–π–≥—ã", russian: "–ì—Ä—É—Å—Ç—å" },
      { tatar: "–ö—É—Ä–∫—É", russian: "–°—Ç—Ä–∞—Ö" }, { tatar: "–Ø—Ä–∞—Ç—É", russian: "–õ—é–±–æ–≤—å" },
      { tatar: "–ê—á—É", russian: "–ì–Ω–µ–≤" }, { tatar: "”®–º–µ—Ç", russian: "–ù–∞–¥–µ–∂–¥–∞" },
    ]
  },
  { id: 25, title: "–°—ã–π—Ñ–∞—Ç–ª–∞—Ä", subtitle: "–ü—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ", icon: "‚ú®", category: "vocabulary", premium: true,
    words: [
      { tatar: "–ó—É—Ä", russian: "–ë–æ–ª—å—à–æ–π" }, { tatar: "–ö–µ—á–∫–µ–Ω”ô", russian: "–ú–∞–ª–µ–Ω—å–∫–∏–π" },
      { tatar: "–ú–∞—Ç—É—Ä", russian: "–ö—Ä–∞—Å–∏–≤—ã–π" }, { tatar: "–Ø—Ö—à—ã", russian: "–•–æ—Ä–æ—à–∏–π" },
      { tatar: "–ù–∞—á–∞—Ä", russian: "–ü–ª–æ—Ö–æ–π" }, { tatar: "–Ø“£–∞", russian: "–ù–æ–≤—ã–π" },
    ]
  },
  { id: 26, title: "–§–∏–≥—ã–ª—å–ª”ô—Ä", subtitle: "–ì–ª–∞–≥–æ–ª—ã", icon: "üèÉ", category: "vocabulary", premium: true,
    words: [
      { tatar: "–ë–∞—Ä—ã—Ä–≥–∞", russian: "–ò–¥—Ç–∏" }, { tatar: "–ö–∏–ª–µ—Ä–≥”ô", russian: "–ü—Ä–∏—Ö–æ–¥–∏—Ç—å" },
      { tatar: "–ê—à–∞—Ä–≥–∞", russian: "–ï—Å—Ç—å" }, { tatar: "–≠—á”ô—Ä–≥”ô", russian: "–ü–∏—Ç—å" },
      { tatar: "–£–∫—ã—Ä–≥–∞", russian: "–ß–∏—Ç–∞—Ç—å" }, { tatar: "–Ø–∑–∞—Ä–≥–∞", russian: "–ü–∏—Å–∞—Ç—å" },
    ]
  },
  { id: 27, title: "–°–æ—Ä–∞—É —Å“Ø–∑–ª”ô—Ä–µ", subtitle: "–í–æ–ø—Ä–æ—Å—ã", icon: "‚ùì", category: "vocabulary", premium: true,
    words: [
      { tatar: "–ö–µ–º?", russian: "–ö—Ç–æ?" }, { tatar: "–ù”ô—Ä—Å”ô?", russian: "–ß—Ç–æ?" },
      { tatar: "–ö–∞–π–¥–∞?", russian: "–ì–¥–µ?" }, { tatar: "–ö–∞–π—á–∞–Ω?", russian: "–ö–æ–≥–¥–∞?" },
      { tatar: "–ù–∏—á–µ–∫?", russian: "–ö–∞–∫?" }, { tatar: "–ù–∏–≥”ô?", russian: "–ü–æ—á–µ–º—É?" },
    ]
  },
  { id: 28, title: "–ë–∞–∑–∞—Ä", subtitle: "–ü–æ–∫—É–ø–∫–∏", icon: "üõí", category: "vocabulary", premium: true,
    words: [
      { tatar: "–ö–∏–±–µ—Ç", russian: "–ú–∞–≥–∞–∑–∏–Ω" }, { tatar: "–ê–∫—á–∞", russian: "–î–µ–Ω—å–≥–∏" },
      { tatar: "–ë”ô—è", russian: "–¶–µ–Ω–∞" }, { tatar: "–†”ô—Ö–º”ô—Ç", russian: "–°–ø–∞—Å–∏–±–æ" },
      { tatar: "–ó–∏–Ω“ª–∞—Ä", russian: "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞" }, { tatar: "–ù–∏—á”ô —Å—É–º?", russian: "–°–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç?" },
    ]
  },
  { id: 29, title: "–§—Ä–∞–∑–∞–ª–∞—Ä", subtitle: "–ü–æ–ª–µ–∑–Ω—ã–µ —Ñ—Ä–∞–∑—ã", icon: "üí¨", category: "vocabulary", premium: true,
    words: [
      { tatar: "–†”ô—Ö–º”ô—Ç", russian: "–°–ø–∞—Å–∏–±–æ" }, { tatar: "–ì–∞—Ñ—É –∏—Ç–µ–≥–µ–∑", russian: "–ò–∑–≤–∏–Ω–∏—Ç–µ" },
      { tatar: "–ú–∏–Ω –∞“£–ª–∞–º—ã–π–º", russian: "–Ø –Ω–µ –ø–æ–Ω–∏–º–∞—é" }, { tatar: "–Ø—Ä–¥”ô–º –∏—Ç–µ–≥–µ–∑", russian: "–ü–æ–º–æ–≥–∏—Ç–µ" },
      { tatar: "–ë–∏–∫ —è—Ö—à—ã", russian: "–û—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ" }, { tatar: "–Ø—Ä—ã–π", russian: "–õ–∞–¥–Ω–æ" },
    ]
  },
  { id: 30, title: "–î–∏–∞–ª–æ–≥", subtitle: "–†–∞–∑–≥–æ–≤–æ—Ä–Ω—ã–µ —Ñ—Ä–∞–∑—ã", icon: "üó£Ô∏è", category: "vocabulary", premium: true,
    words: [
      { tatar: "–ù–∏—á–µ–∫ —Ö”ô–ª–ª”ô—Ä?", russian: "–ö–∞–∫ –¥–µ–ª–∞?" }, { tatar: "–Ø—Ö—à—ã", russian: "–•–æ—Ä–æ—à–æ" },
      { tatar: "–°–∏–Ω–µ“£ –∏—Å–µ–º–µ“£ –Ω–∏—á–µ–∫?", russian: "–ö–∞–∫ —Ç–µ–±—è –∑–æ–≤—É—Ç?" },
      { tatar: "–ú–∏–Ω–µ–º –∏—Å–µ–º–µ–º...", russian: "–ú–µ–Ω—è –∑–æ–≤—É—Ç..." },
      { tatar: "–¢–∞–Ω—ã—à—Ç—ã–≥—ã–º–∞ —à–∞—Ç", russian: "–ü—Ä–∏—è—Ç–Ω–æ –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è" },
    ]
  },
];

const grammarLessons = [
  { id: 31, title: "–ò—Å–µ–º", subtitle: "–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ", icon: "üìñ", category: "grammar", premium: true,
    theory: `–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ: -–ª–∞—Ä/-–ª”ô—Ä\n\n–ü–æ—Å–ª–µ —Ç–≤—ë—Ä–¥—ã—Ö (–∞,–æ,—É,—ã) ‚Üí -–ª–∞—Ä\n–ü–æ—Å–ª–µ –º—è–≥–∫–∏—Ö (”ô,”©,“Ø,–µ,–∏) ‚Üí -–ª”ô—Ä\n\n–ö–∏—Ç–∞–ø ‚Üí –ö–∏—Ç–∞–ø–ª–∞—Ä\n”®–π ‚Üí ”®–π–ª”ô—Ä`,
    examples: [
      { tatar: "–ö–∏—Ç–∞–ø ‚Üí –ö–∏—Ç–∞–ø–ª–∞—Ä", russian: "–ö–Ω–∏–≥–∞ ‚Üí –ö–Ω–∏–≥–∏" },
      { tatar: "”®–π ‚Üí ”®–π–ª”ô—Ä", russian: "–î–æ–º ‚Üí –î–æ–º–∞" },
    ],
    exercises: [
      { question: "–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ—Ç '–º”ô—á–µ'?", answer: "–ú”ô—á–µ–ª”ô—Ä", options: ["–ú”ô—á–µ–ª”ô—Ä", "–ú”ô—á–µ–ª–∞—Ä", "–ú”ô—á”ô–ª”ô—Ä"] },
      { question: "–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ—Ç '–∞–≥–∞—á'?", answer: "–ê–≥–∞—á–ª–∞—Ä", options: ["–ê–≥–∞—á–ª–∞—Ä", "–ê–≥–∞—á–ª”ô—Ä", "–ê–≥–∞—á–Ω–∞—Ä"] },
    ]
  },
  { id: 32, title: "–¢–∞—Ä—Ç—ã–º", subtitle: "–ü—Ä–∏—Ç—è–∂–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å", icon: "üë§", category: "grammar", premium: true,
    theory: `–ü—Ä–∏—Ç—è–∂–∞—Ç–µ–ª—å–Ω—ã–µ –∞—Ñ—Ñ–∏–∫—Å—ã:\n\n–ú–∏–Ω–µ–º -—ã–º/-–µ–º (–º–æ–π)\n–°–∏–Ω–µ“£ -—ã“£/-–µ“£ (—Ç–≤–æ–π)\n–ê–Ω—ã“£ -—ã/-–µ (–µ–≥–æ)\n–ë–µ–∑–Ω–µ“£ -—ã–±—ã–∑/-–µ–±–µ–∑ (–Ω–∞—à)`,
    examples: [
      { tatar: "–ú–∏–Ω–µ–º ”ô–Ω–∏–µ–º", russian: "–ú–æ—è –º–∞–º–∞" },
      { tatar: "–°–∏–Ω–µ“£ ”©–µ“£", russian: "–¢–≤–æ–π –¥–æ–º" },
    ],
    exercises: [
      { question: "'–ú–æ—è –∫–Ω–∏–≥–∞'?", answer: "–ú–∏–Ω–µ–º –∫–∏—Ç–∞–±—ã–º", options: ["–ú–∏–Ω–µ–º –∫–∏—Ç–∞–±—ã–º", "–ú–∏–Ω–µ–º –∫–∏—Ç–∞–ø", "–ú–∏–Ω–µ–º –∫–∏—Ç–∞–±—ã"] },
      { question: "'–ï–≥–æ –¥–æ–º'?", answer: "–ê–Ω—ã“£ ”©–µ", options: ["–ê–Ω—ã“£ ”©–π", "–ê–Ω—ã“£ ”©–µ", "–ê–Ω—ã“£ ”©–µ–º"] },
    ]
  },
  { id: 33, title: "–•”ô–∑–µ—Ä–≥–µ –∑–∞–º–∞–Ω", subtitle: "–ù–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è", icon: "‚è±Ô∏è", category: "grammar", premium: true,
    theory: `–ù–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è: -–∞/-”ô, -—ã–π/-–∏\n\n–ú–∏–Ω —É–∫—ã–π–º ‚Äî –Ø —á–∏—Ç–∞—é\n–°–∏–Ω —É–∫—ã–π—Å—ã“£ ‚Äî –¢—ã —á–∏—Ç–∞–µ—à—å\n–£–ª —É–∫—ã–π ‚Äî –û–Ω —á–∏—Ç–∞–µ—Ç\n–ë–µ–∑ —É–∫—ã–π–±—ã–∑ ‚Äî –ú—ã —á–∏—Ç–∞–µ–º`,
    examples: [
      { tatar: "–ú–∏–Ω —ç—à–ª–∏–º", russian: "–Ø —Ä–∞–±–æ—Ç–∞—é" },
      { tatar: "–£–ª —è–∑–∞", russian: "–û–Ω –ø–∏—à–µ—Ç" },
    ],
    exercises: [
      { question: "'–Ø –∏–¥—É'?", answer: "–ú–∏–Ω –±–∞—Ä–∞–º", options: ["–ú–∏–Ω –±–∞—Ä–∞–º", "–ú–∏–Ω –±–∞—Ä–∞", "–ú–∏–Ω –±–∞—Ä–¥—ã–º"] },
      { question: "'–£–ª' + '—è–∑–∞—Ä–≥–∞' = ?", answer: "–£–ª —è–∑–∞", options: ["–£–ª —è–∑–∞–º", "–£–ª —è–∑–∞", "–£–ª —è–∑–∞–ª–∞—Ä"] },
    ]
  },
  { id: 34, title: "“Æ—Ç–∫”ô–Ω –∑–∞–º–∞–Ω", subtitle: "–ü—Ä–æ—à–µ–¥—à–µ–µ –≤—Ä–µ–º—è", icon: "‚è™", category: "grammar", premium: true,
    theory: `–ü—Ä–æ—à–µ–¥—à–µ–µ –≤—Ä–µ–º—è: -–¥—ã/-–¥–µ, -—Ç—ã/-—Ç–µ\n\n–ú–∏–Ω —è–∑–¥—ã–º ‚Äî –Ø –Ω–∞–ø–∏—Å–∞–ª\n–°–∏–Ω —è–∑–¥—ã“£ ‚Äî –¢—ã –Ω–∞–ø–∏—Å–∞–ª\n–£–ª —è–∑–¥—ã ‚Äî –û–Ω –Ω–∞–ø–∏—Å–∞–ª`,
    examples: [
      { tatar: "–ú–∏–Ω –∫–∏–ª–¥–µ–º", russian: "–Ø –ø—Ä–∏—à—ë–ª" },
      { tatar: "–£–ª –∞—à–∞–¥—ã", russian: "–û–Ω –ø–æ–µ–ª" },
    ],
    exercises: [
      { question: "'–Ø —á–∏—Ç–∞–ª'?", answer: "–ú–∏–Ω —É–∫—ã–¥—ã–º", options: ["–ú–∏–Ω —É–∫—ã–¥—ã–º", "–ú–∏–Ω —É–∫—ã–π–¥—ã–º", "–ú–∏–Ω —É–∫—ã–¥—ã"] },
    ]
  },
  { id: 35, title: "–ö–∏–ª”ô—á”ô–∫ –∑–∞–º–∞–Ω", subtitle: "–ë—É–¥—É—â–µ–µ –≤—Ä–µ–º—è", icon: "‚è©", category: "grammar", premium: true,
    theory: `–ë—É–¥—É—â–µ–µ –≤—Ä–µ–º—è: -–∞—á–∞–∫/-”ô—á”ô–∫\n\n–ú–∏–Ω –±–∞—Ä–∞—á–∞–∫–º—ã–Ω ‚Äî –Ø –ø–æ–π–¥—É\n–°–∏–Ω –±–∞—Ä–∞—á–∞–∫—Å—ã“£ ‚Äî –¢—ã –ø–æ–π–¥—ë—à—å\n–£–ª –±–∞—Ä–∞—á–∞–∫ ‚Äî –û–Ω –ø–æ–π–¥—ë—Ç`,
    examples: [
      { tatar: "–ú–∏–Ω —É–∫—ã—è—á–∞–∫–º—ã–Ω", russian: "–Ø –±—É–¥—É —á–∏—Ç–∞—Ç—å" },
      { tatar: "–£–ª —ç—à–ª”ô—è—á”ô–∫", russian: "–û–Ω –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å" },
    ],
    exercises: [
      { question: "'–Ø –ø—Ä–∏–¥—É'?", answer: "–ú–∏–Ω –∫–∏–ª”ô—á”ô–∫–º–µ–Ω", options: ["–ú–∏–Ω –∫–∏–ª”ô—á”ô–∫–º–µ–Ω", "–ú–∏–Ω –∫–∏–ª–¥–µ–º", "–ú–∏–Ω –∫–∏–ª–∏–º"] },
    ]
  },
];

const lessons = [...vocabularyLessons, ...grammarLessons];

// –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ç–µ—Å—Ç–æ–≤
const generateQuiz = (lesson) => {
  if (lesson.category === 'grammar') {
    return lesson.exercises.sort(() => Math.random() - 0.5).map(ex => ({
      question: ex.question,
      options: [...ex.options].sort(() => Math.random() - 0.5),
      correctAnswer: ex.answer
    }));
  }
  const words = [...lesson.words].sort(() => Math.random() - 0.5).slice(0, 5);
  return words.map(word => {
    const isTatarQ = Math.random() > 0.5;
    const correct = isTatarQ ? word.tatar : word.russian;
    const others = lesson.words.filter(w => w !== word).sort(() => Math.random() - 0.5).slice(0, 2);
    const wrongAnswers = others.map(w => isTatarQ ? w.tatar : w.russian);
    return {
      question: isTatarQ ? `–ö–∞–∫ –±—É–¥–µ—Ç "${word.russian}"?` : `–ß—Ç–æ –∑–Ω–∞—á–∏—Ç "${word.tatar}"?`,
      options: [correct, ...wrongAnswers].sort(() => Math.random() - 0.5),
      correctAnswer: correct
    };
  });
};

// ===== –ì–õ–ê–í–ù–´–ô –ö–û–ú–ü–û–ù–ï–ù–¢ =====
function App() {
  const [screen, setScreen] = React.useState('home');
  const [lesson, setLesson] = React.useState(null);
  const [cardIdx, setCardIdx] = React.useState(0);
  const [flipped, setFlipped] = React.useState(false);
  const [quiz, setQuiz] = React.useState([]);
  const [qIdx, setQIdx] = React.useState(0);
  const [score, setScore] = React.useState(0);
  const [selected, setSelected] = React.useState(null);
  const [filter, setFilter] = React.useState('all');
  const [progress, setProgress] = React.useState({ completed_lessons: [], xp: 0, streak: 0 });
  const [isPremium, setIsPremium] = React.useState(false);
  const [loading, setLoading] = React.useState(true);
  const [purchasing, setPurchasing] = React.useState(false);

  // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
  React.useEffect(() => {
    const loadData = async () => {
      try {
        const userData = await api.getUser();
        setProgress({
          completed_lessons: userData.completed_lessons || [],
          xp: userData.xp || 0,
          streak: userData.streak || 0
        });
        setIsPremium(userData.is_premium || false);
      } catch (e) {
        console.log('API unavailable, using local storage');
        const saved = localStorage.getItem('tatar_progress');
        if (saved) setProgress(JSON.parse(saved));
      }
      setLoading(false);
    };
    loadData();
  }, []);

  // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
  const saveProgress = async (newProgress) => {
    setProgress(newProgress);
    localStorage.setItem('tatar_progress', JSON.stringify(newProgress));
    try {
      await api.saveProgress(newProgress);
    } catch (e) {
      console.log('Failed to save to server');
    }
  };

  const filtered = filter === 'all' ? lessons : lessons.filter(l => l.category === filter);
  const completed = progress.completed_lessons.length;

  const isLessonLocked = (l) => {
    if (isPremium) return false;
    return l.id > FREE_LESSONS;
  };

  const startLesson = (l) => {
    if (isLessonLocked(l)) {
      setScreen('premium');
      return;
    }
    setLesson(l);
    setCardIdx(0);
    setFlipped(false);
    setScreen(l.category === 'grammar' ? 'theory' : 'cards');
  };

  const startQuiz = () => {
    setQuiz(generateQuiz(lesson));
    setQIdx(0);
    setScore(0);
    setSelected(null);
    setScreen('quiz');
  };

  const nextCard = () => {
    const items = lesson.category === 'grammar' ? lesson.examples : lesson.words;
    if (cardIdx < items.length - 1) {
      setCardIdx(cardIdx + 1);
      setFlipped(false);
    } else startQuiz();
  };

  const answer = (opt) => {
    if (selected) return;
    setSelected(opt);
    if (opt === quiz[qIdx].correctAnswer) setScore(score + 1);
  };

  const nextQ = () => {
    if (qIdx < quiz.length - 1) {
      setQIdx(qIdx + 1);
      setSelected(null);
    } else {
      const newCompleted = progress.completed_lessons.includes(lesson.id) 
        ? progress.completed_lessons 
        : [...progress.completed_lessons, lesson.id];
      const newProgress = {
        ...progress,
        completed_lessons: newCompleted,
        xp: progress.xp + score * 10
      };
      saveProgress(newProgress);
      setScreen('results');
    }
  };

  const goHome = () => { setScreen('home'); setLesson(null); };

  const buyPremium = async (months) => {
    setPurchasing(true);
    try {
      const { invoice_url } = await api.createInvoice(months);
      if (tg) {
        tg.openInvoice(invoice_url, async (status) => {
          if (status === 'paid') {
            setIsPremium(true);
            setScreen('home');
          }
          setPurchasing(false);
        });
      } else {
        window.open(invoice_url, '_blank');
        setPurchasing(false);
      }
    } catch (e) {
      alert('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞');
      setPurchasing(false);
    }
  };

  if (loading) {
    return (
      <div className="app">
        <div className="pattern-bg"></div>
        <div className="loading"><div className="spinner"></div></div>
      </div>
    );
  }

  return (
    <div className="app">
      <div className="pattern-bg"></div>
      
      {/* Header */}
      <div style={{padding:'20px',display:'flex',justifyContent:'space-between',alignItems:'center',position:'relative',zIndex:10}}>
        {screen !== 'home' ? (
          <button onClick={goHome} style={{background:'rgba(255,255,255,0.1)',border:'none',borderRadius:12,padding:'10px 16px',color:'#fff',cursor:'pointer',fontWeight:600}}>‚Üê –ê—Ä—Ç–∫–∞</button>
        ) : <div style={{width:80}}/>}
        <div style={{display:'flex',gap:16,alignItems:'center'}}>
          {isPremium && <span className="premium-badge">‚≠ê Premium</span>}
          <div style={{background:'rgba(255,255,255,0.1)',borderRadius:12,padding:'8px 16px',display:'flex',alignItems:'center',gap:8}}>
            <span>üî•</span><span style={{fontWeight:700}}>{progress.streak}</span>
          </div>
          <div style={{background:'rgba(255,255,255,0.1)',borderRadius:12,padding:'8px 16px',display:'flex',alignItems:'center',gap:8}}>
            <span>‚≠ê</span><span style={{fontWeight:700}}>{progress.xp} XP</span>
          </div>
        </div>
      </div>

      <div style={{padding:'0 20px 100px',position:'relative',zIndex:10}}>
        
        {/* HOME */}
        {screen === 'home' && (
          <div>
            <div style={{textAlign:'center',marginBottom:24}}>
              <h1 style={{fontSize:42,marginBottom:8,background:'linear-gradient(135deg,#fff,#4ade80)',WebkitBackgroundClip:'text',WebkitTextFillColor:'transparent'}}>–¢–∞—Ç–∞—Ä—á–∞</h1>
              <p style={{opacity:0.8}}>{isPremium ? '50 —É—Ä–æ–∫–æ–≤' : `${FREE_LESSONS} –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö —É—Ä–æ–∫–æ–≤`}</p>
            </div>
            
            {!isPremium && (
              <div className="premium-banner" onClick={() => setScreen('premium')} style={{cursor:'pointer'}}>
                <div style={{fontSize:24,marginBottom:8}}>‚≠ê –û—Ç–∫—Ä–æ–π –≤—Å–µ 50 —É—Ä–æ–∫–æ–≤!</div>
                <div style={{opacity:0.8,fontSize:14}}>–ì—Ä–∞–º–º–∞—Ç–∏–∫–∞, –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –ª–µ–∫—Å–∏–∫–∞ –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ</div>
              </div>
            )}
            
            <div className="card" style={{padding:24,marginBottom:24,display:'flex',alignItems:'center',gap:20}}>
              <svg width="70" height="70" style={{transform:'rotate(-90deg)'}}>
                <circle cx="35" cy="35" r="30" fill="none" stroke="rgba(255,255,255,0.1)" strokeWidth="8"/>
                <circle cx="35" cy="35" r="30" fill="none" stroke="#4ade80" strokeWidth="8" strokeLinecap="round" strokeDasharray={`${(completed/lessons.length)*188} 188`}/>
              </svg>
              <div>
                <div style={{fontSize:14,opacity:0.7}}>–ü—Ä–æ–≥—Ä–µ—Å—Å</div>
                <div style={{fontSize:24,fontWeight:800}}>{completed} / {lessons.length}</div>
              </div>
            </div>

            <div style={{display:'flex',gap:8,marginBottom:16,flexWrap:'wrap'}}>
              <button className={`filter-btn ${filter==='all'?'active':''}`} onClick={()=>setFilter('all')}>–í—Å–µ ({lessons.length})</button>
              <button className={`filter-btn ${filter==='vocabulary'?'active':''}`} onClick={()=>setFilter('vocabulary')}>–õ–µ–∫—Å–∏–∫–∞</button>
              <button className={`filter-btn ${filter==='grammar'?'active':''}`} onClick={()=>setFilter('grammar')}>–ì—Ä–∞–º–º–∞—Ç–∏–∫–∞</button>
            </div>

            <div className="scrollable" style={{display:'flex',flexDirection:'column',gap:10}}>
              {filtered.map((l,i) => (
                <div key={l.id} className={`card lesson-item ${isLessonLocked(l) ? 'locked' : ''}`} onClick={()=>startLesson(l)} style={{padding:'14px 18px',display:'flex',alignItems:'center',gap:14,cursor:'pointer',animationDelay:`${i*0.03}s`}}>
                  <div style={{width:44,height:44,background:progress.completed_lessons.includes(l.id)?'linear-gradient(135deg,#4ade80,#22c55e)':l.category==='grammar'?'linear-gradient(135deg,#818cf8,#6366f1)':'rgba(255,255,255,0.1)',borderRadius:12,display:'flex',alignItems:'center',justifyContent:'center',fontSize:22}}>
                    {progress.completed_lessons.includes(l.id) ? '‚úì' : l.icon}
                  </div>
                  <div style={{flex:1}}>
                    <div style={{fontWeight:700}}>{l.title}</div>
                    <div style={{opacity:0.7,fontSize:13}}>{l.subtitle}</div>
                  </div>
                </div>
              ))}
            </div>
          </div>
        )}

        {/* PREMIUM */}
        {screen === 'premium' && (
          <div style={{maxWidth:400,margin:'0 auto',textAlign:'center'}}>
            <div style={{fontSize:64,marginBottom:16}}>‚≠ê</div>
            <h2 style={{fontSize:28,marginBottom:8}}>–¢–∞—Ç–∞—Ä—á–∞ Premium</h2>
            <p style={{opacity:0.7,marginBottom:32}}>–û—Ç–∫—Ä–æ–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º 50 —É—Ä–æ–∫–∞–º</p>
            
            <div style={{display:'flex',flexDirection:'column',gap:12,marginBottom:24}}>
              <button className="btn btn-premium" onClick={()=>buyPremium(1)} disabled={purchasing}>
                1 –º–µ—Å—è—Ü ‚Äî 100 ‚≠ê Stars
              </button>
              <button className="btn btn-premium" onClick={()=>buyPremium(3)} disabled={purchasing}>
                3 –º–µ—Å—è—Ü–∞ ‚Äî 250 ‚≠ê Stars <span style={{opacity:0.7}}>(—Å–∫–∏–¥–∫–∞ 17%)</span>
              </button>
              <button className="btn btn-premium" onClick={()=>buyPremium(12)} disabled={purchasing}>
                12 –º–µ—Å—è—Ü–µ–≤ ‚Äî 800 ‚≠ê Stars <span style={{opacity:0.7}}>(—Å–∫–∏–¥–∫–∞ 33%)</span>
              </button>
            </div>
            
            <div className="card" style={{padding:20,textAlign:'left'}}>
              <div style={{fontWeight:700,marginBottom:12}}>–ß—Ç–æ –≤–∫–ª—é—á–µ–Ω–æ:</div>
              <div style={{opacity:0.8,lineHeight:1.8}}>
                ‚úì –í—Å–µ 50 —É—Ä–æ–∫–æ–≤<br/>
                ‚úì 35 —Ç–µ–º –ª–µ–∫—Å–∏–∫–∏<br/>
                ‚úì 15 —É—Ä–æ–∫–æ–≤ –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏<br/>
                ‚úì –ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã<br/>
                ‚úì –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
              </div>
            </div>
          </div>
        )}

        {/* THEORY */}
        {screen === 'theory' && lesson && (
          <div style={{maxWidth:450,margin:'0 auto'}}>
            <div style={{textAlign:'center',marginBottom:24}}>
              <div style={{fontSize:48}}>{lesson.icon}</div>
              <h2>{lesson.title}</h2>
              <p style={{opacity:0.7}}>{lesson.subtitle}</p>
            </div>
            <div className="theory-block">{lesson.theory}</div>
            <button className="btn" onClick={()=>{setCardIdx(0);setFlipped(false);setScreen('cards');}} style={{width:'100%'}}>–ü—Ä–∏–º–µ—Ä–ª–∞—Ä ‚Üí</button>
          </div>
        )}

        {/* CARDS */}
        {screen === 'cards' && lesson && (
          <div style={{maxWidth:400,margin:'0 auto'}}>
            <div style={{textAlign:'center',marginBottom:20}}>
              <h2>{lesson.title}</h2>
            </div>
            <div style={{background:'rgba(255,255,255,0.1)',borderRadius:8,height:8,marginBottom:24,overflow:'hidden'}}>
              <div style={{background:'linear-gradient(90deg,#4ade80,#22c55e)',height:'100%',width:`${((cardIdx+1)/(lesson.category==='grammar'?lesson.examples.length:lesson.words.length))*100}%`,transition:'width 0.3s'}}/>
            </div>
            <div className="flash-card" onClick={()=>setFlipped(!flipped)} style={{marginBottom:24}}>
              <div className={`flash-card-inner card ${flipped?'flipped':''}`}>
                <div className="flash-card-front">
                  <div style={{fontSize:28,fontWeight:800,textAlign:'center'}}>
                    {lesson.category==='grammar' ? lesson.examples[cardIdx].tatar : lesson.words[cardIdx].tatar}
                  </div>
                  <div style={{opacity:0.5,marginTop:20,fontSize:14}}>–¢–∞–ø–Ω–∏ –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞</div>
                </div>
                <div className="flash-card-back">
                  <div style={{fontSize:24,fontWeight:700,color:'#1a472a',textAlign:'center'}}>
                    {lesson.category==='grammar' ? lesson.examples[cardIdx].russian : lesson.words[cardIdx].russian}
                  </div>
                </div>
              </div>
            </div>
            <div style={{display:'flex',gap:12}}>
              <button className="btn btn-secondary" onClick={()=>{if(cardIdx>0){setCardIdx(cardIdx-1);setFlipped(false);}}} disabled={cardIdx===0} style={{flex:1}}>‚Üê</button>
              <button className="btn" onClick={nextCard} style={{flex:2}}>
                {cardIdx===(lesson.category==='grammar'?lesson.examples.length:lesson.words.length)-1 ? '–¢–µ—Å—Ç ‚Üí' : '–ê–ª–≥–∞ ‚Üí'}
              </button>
            </div>
          </div>
        )}

        {/* QUIZ */}
        {screen === 'quiz' && quiz.length > 0 && (
          <div style={{maxWidth:400,margin:'0 auto'}}>
            <div style={{textAlign:'center',marginBottom:20}}>
              <h2>–¢–µ—Å—Ç</h2>
              <p style={{opacity:0.7}}>–°–æ—Ä–∞—É {qIdx+1} / {quiz.length}</p>
            </div>
            <div style={{background:'rgba(255,255,255,0.1)',borderRadius:8,height:8,marginBottom:24,overflow:'hidden'}}>
              <div style={{background:'linear-gradient(90deg,#4ade80,#22c55e)',height:'100%',width:`${((qIdx+1)/quiz.length)*100}%`,transition:'width 0.3s'}}/>
            </div>
            <div className="card" style={{padding:28,marginBottom:20,textAlign:'center'}}>
              <div style={{fontSize:18,fontWeight:700}}>{quiz[qIdx].question}</div>
            </div>
            <div style={{display:'flex',flexDirection:'column',gap:10,marginBottom:20}}>
              {quiz[qIdx].options.map((opt,i) => (
                <button key={i} className={`quiz-option ${selected ? (opt===quiz[qIdx].correctAnswer ? 'correct' : opt===selected ? 'incorrect' : '') : ''}`} onClick={()=>answer(opt)} disabled={!!selected}>{opt}</button>
              ))}
            </div>
            {selected && <button className="btn" onClick={nextQ} style={{width:'100%'}}>{qIdx===quiz.length-1 ? '–ù”ô—Ç–∏“ó”ô–ª”ô—Ä' : '–ê–ª–≥–∞ ‚Üí'}</button>}
          </div>
        )}

        {/* RESULTS */}
        {screen === 'results' && (
          <div style={{maxWidth:400,margin:'0 auto',textAlign:'center'}}>
            <div style={{fontSize:80,marginBottom:16,animation:'pulse 1s infinite'}}>{score>=quiz.length*0.7 ? 'üéâ' : 'üí™'}</div>
            <h2 style={{fontSize:28,marginBottom:8}}>{score>=quiz.length*0.7 ? '–ë–∏–∫ —è—Ö—à—ã!' : '–Ø—Ö—à—ã!'}</h2>
            <p style={{opacity:0.7,marginBottom:24}}>{score>=quiz.length*0.7 ? '–û—Ç–ª–∏—á–Ω–æ!' : '–ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑'}</p>
            <div className="card" style={{padding:28,marginBottom:24}}>
              <div style={{fontSize:42,fontWeight:800,color:'#4ade80'}}>{score} / {quiz.length}</div>
              <div style={{opacity:0.7}}>–¥”©—Ä–µ—Å “ó–∞–≤–∞–ø–ª–∞—Ä</div>
              <div style={{marginTop:16,fontSize:18}}>+{score * 10} XP</div>
            </div>
            <div style={{display:'flex',gap:12}}>
              <button className="btn btn-secondary" onClick={()=>startLesson(lesson)} style={{flex:1}}>üîÑ –ö–∞–±–∞—Ç–ª–∞—Ä–≥–∞</button>
              <button className="btn" onClick={goHome} style={{flex:1}}>‚úì –î”ô–≤–∞–º –∏—Ç”ô—Ä–≥”ô</button>
            </div>
          </div>
        )}
      </div>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(<App />);
</script>
</body>
</html>
